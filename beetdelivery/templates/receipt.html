{% extends 'base.html' %}

<!-- {% load custom_tags %} -->

{% block styles %}
<style>
    
    .form-row {
        display: inline-block;
        margin-right: 10px;
    }

    th {
        padding-top: 25px;
        padding-bottom: 10px;
    }

    td {
        padding-left: 30px;
        padding-right: 30px;
    }

    .save_form {
        padding-top: 25px;
    }
    

</style>
{% endblock %}

{% block content %}

<form method="POST" id="driver-form">
    {% csrf_token %}
    {% for field in form %}
        <div class="form-row">

        {{ field.label_tag }} {{ field }} {{ field.errors }}
        </div>
    {% endfor %}
    <input type="submit" value="Select">
</form>

{% if driver %}
<div id="print-content">
    <h3>Receipt for {{ driver }}</h3>
    <table>
        <thead>
            <tr>
                <th>Farmer&Hill</th>
                <th>Distance(km)</th>
                <th>DPrice</th>
                <th>Density(kg/m3)</th>
                <th>Quantity(m3)</th>
                <th>Price</th>            
            </tr>
        </thead>
        <tbody>
            {% for price in prices %}
            <tr>
                <td>{{ price.0 }}</td>
                <td>{{ price.1 }}</td>
                <td>{{ price.2 }}</td>
                <td>{{ price.3 }}</td>
                <td>{{ price.4 }}</td>
                <td>{{ price.5 }}</td>

            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div><p>Total Price: {{total_price}}</p></div>
    <div><p>Gas Tax: {{gas_tax}}</p></div>
    <div><p>Final Amount: {{final_price}}</p></div>
</div>

<button id="print-button" class="btn btn-primary" >Print</button>
{% endif %}

<script>
    document.getElementById("print-button").addEventListener("click", function(event) {
        event.preventDefault(); // Prevent form submission

        var selectedDriver = document.querySelector('select[name="driver"]').value;
        
        if (selectedDriver) {
            console.log("Selected Driver:", selectedDriver); // Print the selected driver in the console
            var printContent = document.getElementById("print-content").innerHTML;
            var originalContent = document.body.innerHTML;
            document.body.innerHTML = printContent;
            window.print();
            document.body.innerHTML = originalContent;
        } else {
            alert("Please select a driver before printing.");
        }   
    });

    // document.getElementById("print-button").addEventListener("click", function() {
    //    var printContent = document.getElementById("print-content").innerHTML;
    //    var originalContent = document.body.innerHTML
    //    document.body.innerHTML = printContent;
    //    window.print();
    //    document.body.innerHTML = originalContent;
    // });
</script>
{% endblock %}
